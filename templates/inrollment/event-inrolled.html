{% load static %}
<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Webinar Qaamuus</title>

    <!-- Prevent the demo from appearing in search engines -->
    <meta name="robots" content="noindex">
    <link rel="icon" type="image/x-icon" href="{% static "images/logo/favicon-tran.png" %}">
    <link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CRoboto:400,500%7CExo+2:600&display=swap"
        rel="stylesheet">

    <!-- Preloader -->
    <link type="text/css" href="{% static "vendor/spinkit.css" %}" rel="stylesheet">

    <!-- Perfect Scrollbar -->
    <link type="text/css" href="{% static  "vendor/perfect-scrollbar.css" %}" rel="stylesheet">

    <!-- Material Design Icons -->
    <link type="text/css" href="{% static "css/material-icons.css" %}" rel="stylesheet">

    <!-- Font Awesome Icons -->
    <link type="text/css" href="{% static "css/fontawesome.css" %}" rel="stylesheet">

    <!-- Preloader -->
    <link type="text/css" href="{% static "css/preloader.css" %}" rel="stylesheet">

    <!-- App CSS -->
    <link type="text/css" href="{% static "css/app.css" %}" rel="stylesheet">
    <!-- <link type="text/css" href="{% static "css/dark.css" %}" rel="stylesheet"> -->

</head>

<body class="layout-mini layout-mini">

    <div class="preloader">
        <div class="sk-chase">
            <div class="sk-chase-dot"></div>
            <div class="sk-chase-dot"></div>
            <div class="sk-chase-dot"></div>
            <div class="sk-chase-dot"></div>
            <div class="sk-chase-dot"></div>
            <div class="sk-chase-dot"></div>
        </div>

        <!-- <div class="sk-bounce">
    <div class="sk-bounce-dot"></div>
    <div class="sk-bounce-dot"></div>
  </div> -->

        <!-- More spinner examples at https://github.com/tobiasahlin/SpinKit/blob/master/examples.html -->
    </div>

    <!-- Drawer Layout -->

    <div class="mdk-drawer-layout js-mdk-drawer-layout" data-push data-responsive-width="992px">
        <div class="mdk-drawer-layout__content page-content">

            <!-- Header -->

            <div style="background-color: #303840;" class="navbar navbar-expand navbar-dark border-bottom-2" id="default-navbar" data-primary>

                <!-- Navbar toggler -->
                <button class="navbar-toggler w-auto mr-16pt d-block d-lg-none rounded-0" type="button"
                    data-toggle="sidebar">
                    <span class="material-icons">short_text</span>
                </button>

                <!-- Navbar Brand -->
                <a href="index.html" class="navbar-brand mr-16pt d-lg-none">
                    <!-- <img class="navbar-brand-icon" src="../../public/images/logo/white-100@2x.png" width="30" alt="Luma"> -->

                    <span class="avatar avatar-sm navbar-brand-icon mr-0 mr-lg-8pt">

                        <span class="avatar-title rounded bg-primary"><img
                                src="{% static "images/logo/logo-4.png" %}" alt="logo"
                                class="img-fluid" /></span>

                    </span>

                    <span class="d-none d-lg-block">Luma</span>
                </a>

                <ul class="nav navbar-nav d-none d-sm-flex flex justify-content-start ml-8pt">
                    <li class="nav-item active">
                        <a href="#" class="nav-link">QAAMUUS-WEBINAR</a>
                    </li>
                  
                 
                   
                </ul>

                <!-- <form class="search-form navbar-search d-none d-lg-flex mr-16pt" action="index.html"
                    style="max-width: 230px">
                    <button class="btn" type="submit"><i class="material-icons">search</i></button>
                    <input type="text" class="form-control" placeholder="Search ...">
                </form> -->

                <ul class="nav navbar-nav ml-auto mr-0">
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-toggle="tooltip" data-title="Authrized"
                            data-placement="bottom" data-boundary="window"><i style="color: #008abf;" class="material-icons">check_circle</i></a>
                    </li>
          
                    <li class="nav-item nav-item dropdown">
                        <a href="#" class="btn btn-outline-white" data-toggle="dropdown" data-caret="false">{{userInfo.fullName}}</a>
                        <div class="dropdown-menu">
                            <a href="/user-dash/{{userInfo.userType.name}}/{{userInfo.pk}}/brd-info/" class="dropdown-item">Dashboard</a>
                            <a href="/user-edit/{{userInfo.userType.name}}/{{userInfo.pk}}/brd-info/" class="dropdown-item">My-Profile</a>
                            <a  class="dropdown-item" onclick="logoutUser()">Logout</a>
                        </div>
                    </li>
                </ul>
            </div>

            <!-- // END Header -->

            <!-- BEFORE Page Content -->

            <!-- // END BEFORE Page Content -->

            <!-- Page Content -->
            <div class="row">
                <div class="col-sm-12 col-md-7 col-lg-9">
                    <div class="js-player card bg-primary text-center embed-responsive embed-responsive-16by9 mb-24pt">
                       
                        <div class="player embed-responsive-item">
                            <!-- <span style="margin-right: 5px;position: absolute;" class="text-right">LIVE</span> -->
                            <video width="100%" height="100%" id="liveVideoTag"  style="border: none; position: absolute; top: 0; height: 100%; width: 100%;" >
                                <source src="{{theEvent.videoUrl.url}}" type="video/mp4">
                            </video>
                            <!-- <iframe class="embed-responsive-item" src="{{theEvent.prevVideo}}" allowfullscreen=""></iframe> -->
    
                        </div>
                    </div>
                    
                    <div style="margin-top: -20px;" class="border-bottom-2 py-16pt navbar-light bg-white border-bottom-2">
                        <!-- <div class="position-relative carousel-card">
                            <div class="js-mdk-carousel row d-block" id="carousel-courses1">

                                <a class="carousel-control-next js-mdk-carousel-control mt-n24pt"
                                    href="#carousel-courses1" role="button" data-slide="next">
                                    <span class="carousel-control-icon material-icons"
                                        aria-hidden="true">keyboard_arrow_right</span>
                                    <span class="sr-only">Next</span>
                                </a>

                                <div class="mdk-carousel__content">
                                    {% for inrolledUser in theEvent.enrolledStudents.all %}
                                    <div class="col-lg-2 col-md-2 col-sm-4">
                                        <div  class="card card-sm card--elevated p-relative o-hidden overlay overlay--primary-dodger-blue js-overlay mdk-reveal js-mdk-reveal "
                                            data-partial-height="40" >

                                            <a  class="js-image" data-position="">
                                                <img width="100%" height="90" src="{{inrolledUser.profileImage.url}}"
                                                    alt="course">
                                                <span
                                                    class="overlay__content align-items-start justify-content-start">
                                                    <span
                                                        class="overlay__action card-body d-flex align-items-center">
                                                        <i class="material-icons mr-4pt">play_circle_outline</i>
                                                        <span class="card-title text-white">Resume</span>
                                                    </span>
                                                </span>
                                            </a>
                                            
                                            <div class="mdk-reveal__content">
                                                <div class="card-body">
                                                    <div class="d-flex">
                                                        <div class="flex">
                                                            <a class="card-title" >{{inrolledUser.fullName}}</a>
                                                        </div>
                                                        
                                                    </div>
                                                  
                                                </div>
                                            </div>
                                        </div>
                                        
                                    </div>
                                    {% endfor %}
                                  

                                </div>
                                <a class="carousel-control-prev" href="#carouselExampleFade" role="button" data-slide="prev">
                                    <span class="carousel-control-icon material-icons" aria-hidden="true">keyboard_arrow_left</span>
                                    <span class="sr-only">Previous</span>
                                </a>
                                
                            </div>
                        </div> -->
                        <div class="container page__container">
                           


                            <!-- <div class="row align-items-center">
                                <div
                                    class="d-flex col-md align-items-center border-bottom border-md-0 mb-16pt mb-md-0 pb-16pt pb-md-0">
                                    <div
                                        class="rounded-circle bg-primary w-64 h-64 d-inline-flex align-items-center justify-content-center mr-16pt">
                                        <i class="material-icons text-white">subscriptions</i>
                                    </div>
                                    <div class="flex">
                                        <div class="card-title mb-4pt">8,000+ Courses</div>
                                        <p class="card-subtitle text-70">Explore a wide range of skills.</p>
                                    </div>
                                </div>
                                <div
                                    class="d-flex col-md align-items-center border-bottom border-md-0 mb-16pt mb-md-0 pb-16pt pb-md-0">
                                    <div
                                        class="rounded-circle bg-primary w-64 h-64 d-inline-flex align-items-center justify-content-center mr-16pt">
                                        <i class="material-icons text-white">verified_user</i>
                                    </div>
                                    <div class="flex">
                                        <div class="card-title mb-4pt">By Industry Experts</div>
                                        <p class="card-subtitle text-70">Professional development from the best people.</p>
                                    </div>
                                </div>
                                <div class="d-flex col-md align-items-center">
                                    <div
                                        class="rounded-circle bg-primary w-64 h-64 d-inline-flex align-items-center justify-content-center mr-16pt">
                                        <i class="material-icons text-white">update</i>
                                    </div>
                                    <div class="flex">
                                        <div class="card-title mb-4pt">Unlimited Access</div>
                                        <p class="card-subtitle text-70">Unlock Library and learn any topic with one
                                            subscription.</p>
                                    </div>
                                </div>
                            </div> -->
                        </div>
                    </div>
                </div>
                <div class="col-sm-12 col-md-5 col-lg-3">
                    <div class="card">
                        <!-- <img class="card-img-top" height="80px" style="object-fit: cover;"  src="http://unblast.com/wp-content/uploads/2021/02/Online-Learning-Mobile-App-Template.jpg" alt="Card image cap"> -->
                        <div class="card-header">
                            <strong>You Comment</strong> 
                        </div>
                    
                        <div style="height: 70vh; overflow-y: auto; " class="card-body">
                            
                            <ul  class="d-flex flex-column list-unstyled" id="messages">
                                
                            </ul>
                        </div>
                        <div class="card-footer">
                            <form id="liveCommentForm" class="search-form search-form--white pl-16pt">
                                <input type="text" name="commentText" class="form-control pl-0" placeholder="You Comment Here">
                                <button class="btn" type="submit"><i class="material-icons">send</i></button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            

            


     

          

            <!-- // END Page Content -->

            <!-- Footer -->

            <div class="bg-white border-top-2 mt-auto">
                <div class="container page__container page-section d-flex flex-column">
                    <p class="text-70 brand mb-24pt">
                        <img class="brand-icon" src="{% static "images/logo/logo-4.png" %}" width="30" alt="Luma">
                        QAAMUUS-WEBINAR
                    </p>
                    <!-- <p class="measure-lead-max text-50 small mr-8pt">Luma is a beautifully crafted user interface for
                        modern Education Platforms, including Courses & Tutorials, Video Lessons, Student and Teacher
                        Dashboard, Curriculum Management, Earnings and Reporting, ERP, HR, CMS, Tasks, Projects,
                        eCommerce and more.</p> -->
                    <!-- <p class="mb-8pt d-flex">
                        <a href="" class="text-70 text-underline mr-8pt small">Terms</a>
                        <a href="" class="text-70 text-underline small">Privacy policy</a>
                    </p> -->
                    <p class="text-50 small mt-n1 mb-0">Copyright 2019 &copy; All rights reserved.</p>
                </div>
            </div>

            <!-- // END Footer -->

        </div>

        <!-- // END drawer-layout__content -->

        <!-- drawer -->
        <div class="mdk-drawer js-mdk-drawer layout-mini__drawer" id="default-drawer">
            <div class="mdk-drawer__content js-sidebar-mini" data-responsive-width="992px" data-layout="mini">

                <div class="sidebar sidebar-mini sidebar-dark-pickled-bluewood sidebar-left d-flex flex-column">

                    <!-- Brand -->
                    <a href="index.html" class="sidebar-brand p-0 navbar-height d-flex justify-content-center">

                        <span class="avatar avatar-sm ">

                            <span class="avatar-title rounded bg-primary"><img
                                src="{% static "images/logo/logo-4.png" %}" class="img-fluid"
                                    alt="logo" /></span>

                        </span>

                    </a>

                    <div class="flex d-flex flex-column justify-content-start" data-perfect-scrollbar>
                        <ul class="nav flex-shrink-0 flex-nowrap flex-column sidebar-menu mb-0 js-sidebar-mini-tabs"
                            role="tablist">
                            <li class="sidebar-menu-item active" data-toggle="tooltip" data-title="Student"
                                data-placement="right" data-boundary="window">
                                <a class="sidebar-menu-button" href="#sm_student" data-toggle="tab" role="tab"
                                    aria-controls="sm_student" aria-selected="true">
                                    <i class="sidebar-menu-icon sidebar-menu-icon--left material-icons">school</i>
                                    <span class="sidebar-menu-text">Student</span>
                                </a>
                            </li>
                            <li class="sidebar-menu-item" data-toggle="tooltip" data-title="Instructor"
                                data-placement="right" data-container="body" data-boundary="window">
                                <a class="sidebar-menu-button" href="#sm_instructor" data-toggle="tab" role="tab"
                                    aria-controls="sm_instructor" aria-selected="false">
                                    <i
                                        class="sidebar-menu-icon sidebar-menu-icon--left material-icons">format_shapes</i>
                                    <span class="sidebar-menu-text">Instructor</span>
                                </a>
                            </li>
                            <li class="sidebar-menu-item " data-toggle="tooltip" data-title="Apps"
                                data-placement="right" data-container="body" data-boundary="window">
                                <a class="sidebar-menu-button" href="#sm_apps" data-toggle="tab" role="tab"
                                    aria-controls="sm_apps">
                                    <i class="sidebar-menu-icon sidebar-menu-icon--left material-icons">apps</i>
                                    <span class="sidebar-menu-text">Apps</span>
                                </a>
                            </li>
                            <li class="sidebar-menu-item " data-toggle="tooltip" data-title="Account"
                                data-placement="right" data-container="body" data-boundary="window">
                                <a class="sidebar-menu-button" href="#sm_account" data-toggle="tab" role="tab"
                                    aria-controls="sm_account">
                                    <i class="sidebar-menu-icon sidebar-menu-icon--left material-icons">account_box</i>
                                    <span class="sidebar-menu-text">Account</span>
                                </a>
                            </li>
                            <li class="sidebar-menu-item " data-toggle="tooltip" data-title="Messaging"
                                data-placement="right" data-container="body" data-boundary="window">
                                <a class="sidebar-menu-button" href="#sm_messaging" data-toggle="tab" role="tab"
                                    aria-controls="sm_messaging">
                                    <i class="sidebar-menu-icon sidebar-menu-icon--left material-icons">message</i>
                                    <span class="sidebar-menu-text">Messaging</span>
                                </a>
                            </li>
                            <li class="sidebar-menu-item" data-toggle="tooltip" data-title="Components"
                                data-placement="right" data-container="body" data-boundary="window">
                                <a class="sidebar-menu-button" href="#sm_components" data-toggle="tab" role="tab"
                                    aria-controls="sm_components">
                                    <i class="sidebar-menu-icon sidebar-menu-icon--left material-icons">tune</i>
                                    <span class="sidebar-menu-text">Components</span>
                                </a>
                            </li>
                            <li class="sidebar-menu-item" data-toggle="tooltip" data-title="Layouts"
                                data-placement="right" data-boundary="window">
                                <a class="sidebar-menu-button" href="#sm_layouts" data-toggle="tab" role="tab"
                                    aria-controls="sm_layouts" aria-selected="false">
                                    <i class="sidebar-menu-icon sidebar-menu-icon--left material-icons">view_compact</i>
                                    <span class="sidebar-menu-text">Layouts</span>
                                </a>
                            </li>
                        </ul>
                    </div>

                </div>


            </div>
        </div>
        <!-- // END drawer -->

    </div>

    <!-- // END Drawer Layout -->

    <!-- jQuery -->
    <script src="{% static "js/acommon_functions.js" %}"></script>
    <script src="{% static "vendor/jquery.min.js" %}"></script>
    <script src="{% static "js/sweetalert2.js" %}"></script>

    <!-- Bootstrap -->
    <script src="{% static "vendor/popper.min.js" %}"></script>
    <script src="{% static "vendor/bootstrap.min.js" %}"></script>

    <!-- Perfect Scrollbar -->
    <script src="{% static "vendor/perfect-scrollbar.min.js" %}"></script>

    <!-- DOM Factory -->
    <script src="{% static "vendor/dom-factory.js" %}"></script>

    <!-- MDK -->
    <script src="{% static "vendor/material-design-kit.js" %}"></script>

    <!-- App JS -->
    <script src="{% static "js/app.js" %}"></script>

    <!-- Preloader -->
    <script src="{% static "js/preloader.js" %}"></script>

    <!-- Sidebar Mini JS -->
    <script src="{% static "js/sidebar-mini.js" %}"></script>
    <script>
        
        var liveCommentDiv = document.getElementById('messages');
        var videoStartedTime = '{{theEvent.dateTimeStarting|date:"Y-m-d H:i"}}'
        videoStartedTime = new Date(videoStartedTime)
        var theCurrentTime = new Date()
        var liveVideoTag = document.getElementById('liveVideoTag')
        // $("#liveVideoTag").on(
        //     "play", 
        //     function(event){
        //         liveVideoTag.pause()
        //         liveVideoTag.currentTime=10.01
        //     console.log(typeof(liveVideoTag.currentTime))
        //         liveVideoTag.play()

                
        // });
        $(function () {
            getLiveComment()
            
            'use strict';
            // ENABLE sidebar menu tabs
            $('.js-sidebar-mini-tabs [data-toggle="tab"]').on('click', function (e) {
                e.preventDefault()
                $(this).tab('show')
            })
            $('.js-sidebar-mini-tabs').on('show.bs.tab', function (e) {
                $('.js-sidebar-mini-tabs > .active').removeClass('active')
                $(e.target).parent().addClass('active')
            })
        })

     
        
        // liveVideoTag.on('play',()=>{
        //     console.log('played')
        //     liveVideoTag.currentTime(70.022);
        // })
      
        // liveVideoTag.on('play', () => {
        //     theCurrentTime = new Date()
        //     const diffTime = Math.abs(theCurrentTime - videoStartedTime);
        //     console.log(theCurrentTime)
        //     console.log('deffrent '+(diffTime /1000).toFixed(0))
            
        //     console.log('duration '+liveVideoTag.duration().toFixed(0))
        //     if( parseInt((diffTime /1000).toFixed(0)) < parseInt(liveVideoTag.duration().toFixed(0))){
        //         console.log('its nede')
        //         // liveVideoTag.currentTime((diffTime /1000).toFixed(0))
        //         console.log( liveVideoTag.currentTime())
        //     }else{
                
        //         console.log('its nott')
        //         liveVideoTag.pause()
        //         liveVideoTag.currentTime((diffTime /1000).toFixed(0))
        //     }
        //     // console.log(diffDays + " days");
        // });



        document.getElementById('liveCommentForm').addEventListener('submit',async function (e) {
            e.preventDefault()
            var commentText = $('[name=commentText]').val()
            await $.ajax({
                type: "POST",
                data: { 'theUser': '{{userInfo.pk}}', 'theEvent': '{{theEvent.pk}}', 'commentText': commentText },
                headers: { 'X-CSRFToken': getCookie('csrftoken') },
                url: '/api/liveEventComment-create/',
                success: function (liveCommentResp) {
                    getLiveComment()
                },
            })

        })
        async function getLiveComment() {
            liveCommentDiv.innerHTML = ``
            fetch('/api/this-event-liveEventComment-list/{{theEvent.pk}}/').then((resp) => resp.json()).then(function (liveCommentResp) {
                for (var liveComment of liveCommentResp) {
                    liveCommentDiv.innerHTML += `
                        <li class="message d-inline-flex">
                            <div class="message__aside">
                                <a href="profile.html" class="avatar avatar-sm">
                                    <img src="${liveComment.theUser.profileImage}" alt="people"
                                        class="avatar-img rounded-circle">
                                </a>
                            </div>
                            <div class="message__body card">
                                <div class="card-body">
                                    <div class="d-flex align-items-center">
                                        <div class="flex mr-3">
                                            <a href="profile.html"
                                                class="text-body"><strong>${liveComment.theUser.fullName}</strong></a>
                                        </div>
                                        <div>
                                            <small class="text-50">${timeSince(new Date(liveComment.dateTr))}</small>
                                        </div>
                                    </div>
                                    <span class="text-70">${liveComment.commentText}</span>

                                </div>
                            </div>
                        </li>
                    `
                }
            })
        }
        function timeSince(date) {
            var seconds = Math.floor((new Date() - date) / 1000);

            var interval = seconds / 31536000;

            if (interval > 1) {
                return Math.floor(interval) + " years";
            }
            interval = seconds / 2592000;
            if (interval > 1) {
                return Math.floor(interval) + " months";
            }
            interval = seconds / 86400;
            if (interval > 1) {
                return Math.floor(interval) + " days";
            }
            interval = seconds / 3600;
            if (interval > 1) {
                return Math.floor(interval) + " hours";
            }
            interval = seconds / 60;
            if (interval > 1) {
                return Math.floor(interval) + " minutes";
            }
                return Math.floor(seconds) + " seconds";
            }
        var aDay = 24*60*60*1000;
        // console.log(timeSince(new Date()));
    </script>
</body>

</html>